#!/bin/sh
PROG_NAME=$(basename $0)
MSG_PREFIX="$PROG_NAME[$(basename "$(pwd)")]"
INTERNAL_IN=.kianidraw/in

exit_bad_location() {
	echo "$PROG_NAME: not in a valid/usable kianidraw project, please cd and/or check permissions" >&2
	exit 1
}

test -d $INTERNAL_IN || exit_bad_location
find . -type d | xargs chmod u+rwx || exit_bad_location
find . -type f | xargs chmod u+rw  || exit_bad_location

test -n "$1" || {
	echo "$MSG_PREFIX: 1 arg required: <resourceName>" >&2
	exit 64
}

test -f $INTERNAL_IN/"$1.d/$1.xcf" || {
	echo "$MSG_PREFIX: \"$1\": resource not found" >&2
	exit 1
}

gimp $INTERNAL_IN/$1.d/$1.xcf &
